ANOVA is computed in **2.7.5** via SciPy:

```python
stat, p_val = stats.f_oneway(*grouped_values)
```

That returns an **F-statistic** and **p-value** only. No sums-of-squares. That is why your `anova_kruskal_results.csv` has only `statistic` and `p_value`.

## If you want η² or partial η², you must change 2.7.5 logging

You have two viable paths.

### Option A (recommended): compute SS directly from the data you already have

You already have `sub` and `grouped_values`. You can compute:

* `ss_between`
* `ss_within`
* `ss_total`
* `df_between = k-1`
* `df_within = N-k`
* and then `eta_squared = ss_between / ss_total`

This avoids extra libraries and stays consistent with your SciPy ANOVA.

Drop this inline inside the ANOVA block, right after `stat, p_val = stats.f_oneway(*grouped_values)` succeeds:

```python
# compute ANOVA SS terms for eta^2
k = len(grouped_values)
Ns = [len(v) for v in grouped_values]
N = int(sum(Ns))

means = [float(np.mean(v)) for v in grouped_values]
grand_mean = float(np.sum([Ns[i] * means[i] for i in range(k)]) / N)

ss_between = float(np.sum([Ns[i] * (means[i] - grand_mean) ** 2 for i in range(k)]))
ss_within = float(np.sum([np.sum((grouped_values[i] - means[i]) ** 2) for i in range(k)]))
ss_total = float(ss_between + ss_within)

df_between = int(k - 1)
df_within = int(N - k)

eta_sq = (ss_between / ss_total) if ss_total > 0 else np.nan
```

Then add these columns to the row you append:

```python
"n_total": N,
"k_groups": k,
"df_between": df_between,
"df_within": df_within,
"ss_between": ss_between,
"ss_within": ss_within,
"ss_total": ss_total,
"eta_squared": eta_sq,
```

Partial η² is not meaningful for one-way ANOVA. For one-way, η² = partial η².

### Option B: switch to statsmodels ANOVA table

More overhead. Gives classic ANOVA table, but you are already doing one-way grouped ANOVA, so Option A is cleaner.

## Kruskal effect sizes

For Kruskal-Wallis, you can log **epsilon-squared** (ε²) without z or SS:

Given H statistic, N, k:

* ε² = (H − k + 1) / (N − k)

You already have `stat` and you can compute N and k in the same loop. Add this after `stats.kruskal(*grouped_values)`:

```python
k = len(grouped_values)
N = int(sum([len(v) for v in grouped_values]))
eps_sq = (float(stat) - k + 1) / (N - k) if (N > k) else np.nan
```

Then log:

```python
"n_total": N,
"k_groups": k,
"epsilon_squared": eps_sq,
```

## Why you saw “no SS columns”

Because 2.7.5 never computes them. It cannot appear downstream.

If you add the fields above to `anova_kruskal_results.csv`, then 2.7.11 can compute and report η² immediately, conditionally, with no other changes.

# 2.7.5 | Categorical–Numeric Relationship Tests (ANOVA / Kruskal)
print("2.7.5 | Categorical–Numeric Relationship Tests")

catnum_cfg = CONFIG.get("CAT_NUM_RELATIONSHIPS", {})

catnum_enabled_275 = bool(catnum_cfg.get("ENABLED", True))
catnum_group_by_275 = catnum_cfg.get("GROUP_BY", [])
catnum_numeric_targets_cfg_275 = catnum_cfg.get("NUMERIC_TARGETS", "all_numeric")
catnum_methods_cfg_275 = catnum_cfg.get("METHODS", {"ANOVA": True, "KRUSKAL": True})
catnum_p_thresh_275 = float(catnum_cfg.get("P_VALUE_THRESHOLD", 0.05))
catnum_output_file_275 = catnum_cfg.get("OUTPUT_FILE", "anova_kruskal_results.csv")

anova_enabled_275 = bool(catnum_methods_cfg_275.get("ANOVA", True))
kruskal_enabled_275 = bool(catnum_methods_cfg_275.get("KRUSKAL", True))

catnum_rows_275 = []
n_tests_run_275 = 0
n_significant_275 = 0
catnum_detail_275 = None
catnum_status_275 = "SKIPPED"

if not catnum_enabled_275:
    print("   ⚠️ 2.7.5 disabled via CONFIG.CAT_NUM_RELATIONSHIPS.ENABLED = False")
else:
    # Resolve group-by columns present in df
    group_cols_present_275 = [g for g in catnum_group_by_275 if g in df_27.columns]

    # Determine numeric targets
    all_numeric_cols_275 = []
    for col in df_27.columns:
        if pd.api.types.is_numeric_dtype(df_27[col]) and not is_bool_like(df_27[col]):
            nunique = df_27[col].nunique(dropna=True)
            if "id" in col.lower() and nunique > 0.9 * len(df_27):
                continue
            all_numeric_cols_275.append(col)

    if isinstance(catnum_numeric_targets_cfg_275, str) and catnum_numeric_targets_cfg_275 == "all_numeric":
        numeric_targets_275 = all_numeric_cols_275
    elif isinstance(catnum_numeric_targets_cfg_275, (list, tuple, set)):
        numeric_targets_275 = [c for c in catnum_numeric_targets_cfg_275 if c in df_27.columns]
    else:
        numeric_targets_275 = [c for c in all_numeric_cols_275 if c == catnum_numeric_targets_cfg_275 and c in df_27.columns]

    if not group_cols_present_275:
        print("   ⚠️ 2.7.5: no GROUP_BY columns present in dataframe; logging SKIPPED.")
    elif not numeric_targets_275:
        print("   ⚠️ 2.7.5: no numeric targets resolved; logging SKIPPED.")
    else:
        for group_col in group_cols_present_275:
            # Ensure group_col behaves as categorical
            groups = df_27[group_col].dropna().unique()
            if len(groups) < 2:
                print(f"   ⚠️ 2.7.5: group column '{group_col}' has <2 unique groups; skipping.")
                continue

            for numeric_feature in numeric_targets_275:
                sub = df_27[[group_col, numeric_feature]].dropna()
                if sub.empty:
                    continue

                grouped_values = []
                group_sizes = []
                for g in sub[group_col].unique():
                    vals = sub.loc[sub[group_col] == g, numeric_feature].dropna()
                    if len(vals) >= 2:
                        grouped_values.append(vals.values.astype(float))
                        group_sizes.append(len(vals))

                if len(grouped_values) < 2:
                    continue

                min_group_size = min(group_sizes) if group_sizes else 0
                note_imbalance = "imbalanced groups" if min_group_size < 10 else ""

                # ANOVA
                if anova_enabled_275:
                    try:
                        stat, p_val = stats.f_oneway(*grouped_values)
                        significant = bool(p_val <= catnum_p_thresh_275)
                        n_tests_run_275 += 1
                        if significant:
                            n_significant_275 += 1
                        catnum_rows_275.append({
                            "group_feature": group_col,
                            "numeric_feature": numeric_feature,
                            "method": "ANOVA",
                            "statistic": float(stat),
                            "p_value": float(p_val),
                            "significant": significant,
                            "notes": note_imbalance
                        })
                    except Exception as e:
                        catnum_rows_275.append({
                            "group_feature": group_col,
                            "numeric_feature": numeric_feature,
                            "method": "ANOVA",
                            "statistic": np.nan,
                            "p_value": np.nan,
                            "significant": False,
                            "notes": f"ERROR: {e}"
                        })

                # Kruskal–Wallis
                if kruskal_enabled_275:
                    try:
                        stat, p_val = stats.kruskal(*grouped_values)
                        significant = bool(p_val <= catnum_p_thresh_275)
                        n_tests_run_275 += 1
                        if significant:
                            n_significant_275 += 1
                        catnum_rows_275.append({
                            "group_feature": group_col,
                            "numeric_feature": numeric_feature,
                            "method": "KRUSKAL",
                            "statistic": float(stat),
                            "p_value": float(p_val),
                            "significant": significant,
                            "notes": note_imbalance
                        })
                    except Exception as e:
                        catnum_rows_275.append({
                            "group_feature": group_col,
                            "numeric_feature": numeric_feature,
                            "method": "KRUSKAL",
                            "statistic": np.nan,
                            "p_value": np.nan,
                            "significant": False,
                            "notes": f"ERROR: {e}"
                        })

        if catnum_rows_275:
            df_catnum_275 = pd.DataFrame(catnum_rows_275)
            path_275 = sec2_27_dir / catnum_output_file_275
            df_catnum_275.to_csv(path_275, index=False)
            print(f"   ✅ 2.7.5 ANOVA / Kruskal results written to: {path_275}")
            catnum_detail_275 = str(path_275)

        if n_tests_run_275 == 0:
            catnum_status_275 = "SKIPPED"
        else:
            catnum_status_275 = "OK"

# Unified Section 2 summary row for 2.7.5
summary_275 = pd.DataFrame([{
    "section":       "2.7.5",
    "section_name":  "Categorical–numeric relationship tests",
    "check":         "Run ANOVA/Kruskal tests for numeric differences across categories",
    "level":         "info",
    "status":        catnum_status_275,
    "n_tests_run":   int(n_tests_run_275),
    "n_significant": int(n_significant_275),
    "detail":        catnum_detail_275,
    "timestamp":     pd.Timestamp.utcnow(),
    "notes":          None,
}])

append_sec2(summary_275, SECTION2_REPORT_PATH)
display(summary_275)

# anova_kruskal_results.csv:
group_feature,numeric_feature,method,statistic,p_value,significant,notes
gender,tenure,ANOVA,0.18399119852151938,0.6679785916861012,False,
gender,tenure,KRUSKAL,0.08579459977434807,0.7695931218868794,False,
gender,MonthlyCharges,ANOVA,1.4858266478556317,0.22290594544454972,False,
gender,MonthlyCharges,KRUSKAL,1.3331362140884433,0.2482480475318829,False,
gender,TotalCharges,ANOVA,4.343650500951582e-06,0.9983371550052766,False,
gender,TotalCharges,KRUSKAL,0.013808892767344986,0.9064549333391331,False,
gender,expected_total_from_tenure_monthly,ANOVA,1.770870108584192e-05,0.99664249463964,False,
gender,expected_total_from_tenure_monthly,KRUSKAL,0.007901074941323045,0.929170927577545,False,
gender,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
gender,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
gender,expected_min_total_from_contract,ANOVA,0.1376146322144668,0.7106751616274172,False,
gender,expected_min_total_from_contract,KRUSKAL,0.015897313104292113,0.8996649992019711,False,
gender,expected_total_senior,ANOVA,0.17684009348269542,0.6741822519159026,False,
gender,expected_total_senior,KRUSKAL,2.99554263451624e-05,0.9956330758784313,False,
gender,expected_total_from_payment_profile,ANOVA,1.770870108584192e-05,0.99664249463964,False,
gender,expected_total_from_payment_profile,KRUSKAL,0.007901074941323045,0.929170927577545,False,
gender,total_charges_per_month,ANOVA,1.4960403481195972,0.22132256031899264,False,
gender,total_charges_per_month,KRUSKAL,1.5940241676731253,0.20675213344663687,False,
SeniorCitizen,tenure,ANOVA,1.9268064869607664,0.16515217318125727,False,
SeniorCitizen,tenure,KRUSKAL,2.401347394508528,0.12123079310052007,False,
SeniorCitizen,MonthlyCharges,ANOVA,359.20580490195124,3.6122337229899922e-78,True,
SeniorCitizen,MonthlyCharges,KRUSKAL,344.14113288365354,7.998735545266436e-77,True,
SeniorCitizen,TotalCharges,ANOVA,75.97303161026875,3.5434142652655805e-18,True,
SeniorCitizen,TotalCharges,KRUSKAL,82.4013986327594,1.1107517592830664e-19,True,
SeniorCitizen,expected_total_from_tenure_monthly,ANOVA,76.12662593099273,3.280973330967812e-18,True,
SeniorCitizen,expected_total_from_tenure_monthly,KRUSKAL,83.08853574550909,7.845940038339221e-20,True,
SeniorCitizen,expected_min_total_from_contract,ANOVA,15.442017127884233,8.588989265616236e-05,True,
SeniorCitizen,expected_min_total_from_contract,KRUSKAL,60.01168722896875,9.429578217181956e-15,True,
SeniorCitizen,expected_total_from_payment_profile,ANOVA,76.12662593099273,3.280973330967812e-18,True,
SeniorCitizen,expected_total_from_payment_profile,KRUSKAL,83.08853574550909,7.845940038339221e-20,True,
SeniorCitizen,total_charges_per_month,ANOVA,353.5621852082483,5.339316175499689e-77,True,
SeniorCitizen,total_charges_per_month,KRUSKAL,335.92878133869937,4.915017811929582e-75,True,
Partner,tenure,ANOVA,1186.6430442786018,1.8524097651994337e-240,True,
Partner,tenure,KRUSKAL,1045.1451222457774,2.7641240327847095e-229,True,
Partner,MonthlyCharges,ANOVA,66.57474902702762,3.957443339093459e-16,True,
Partner,MonthlyCharges,KRUSKAL,82.84820608782582,8.860262386092258e-20,True,
Partner,TotalCharges,ANOVA,790.1363954244722,7.280538288871833e-165,True,
Partner,TotalCharges,KRUSKAL,815.718752429026,2.063300914380667e-179,True,
Partner,expected_total_from_tenure_monthly,ANOVA,790.0233196109975,7.660695237555793e-165,True,
Partner,expected_total_from_tenure_monthly,KRUSKAL,816.4759508294044,1.4123360429244469e-179,True,
Partner,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
Partner,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
Partner,expected_min_total_from_contract,ANOVA,527.1854879017146,1.4520890618641787e-112,True,
Partner,expected_min_total_from_contract,KRUSKAL,572.1008580878472,1.960311324714007e-126,True,
Partner,expected_total_senior,ANOVA,128.27517522225858,2.9626904882093984e-28,True,
Partner,expected_total_senior,KRUSKAL,122.47636189251563,1.8156558530594423e-28,True,
Partner,expected_total_from_payment_profile,ANOVA,790.0233196109975,7.660695237555793e-165,True,
Partner,expected_total_from_payment_profile,KRUSKAL,816.4759508294044,1.4123360429244469e-179,True,
Partner,total_charges_per_month,ANOVA,63.59455331370205,1.7709165105699118e-15,True,
Partner,total_charges_per_month,KRUSKAL,76.9268379858089,1.7740980948531686e-18,True,
Dependents,tenure,ANOVA,184.564893949792,1.624291989899316e-41,True,
Dependents,tenure,KRUSKAL,190.8014743667274,2.1251441373824966e-43,True,
Dependents,MonthlyCharges,ANOVA,92.72406599047804,8.189516821746845e-22,True,
Dependents,MonthlyCharges,KRUSKAL,80.68138144139442,2.652092064328204e-19,True,
Dependents,TotalCharges,ANOVA,27.214344831749703,1.8729793312450528e-07,True,
Dependents,TotalCharges,KRUSKAL,43.355972538828745,4.5634122700011917e-11,True,
Dependents,expected_total_from_tenure_monthly,ANOVA,27.398545390948662,1.7034184019364646e-07,True,
Dependents,expected_total_from_tenure_monthly,KRUSKAL,43.81086895700765,3.6169081887811306e-11,True,
Dependents,expected_min_total_from_contract,ANOVA,131.29614455469545,3.940339941477896e-30,True,
Dependents,expected_min_total_from_contract,KRUSKAL,245.09950337316639,3.0397211039997987e-55,True,
Dependents,expected_total_senior,ANOVA,19.81795494573662,9.353716876920004e-06,True,
Dependents,expected_total_senior,KRUSKAL,19.260229221613574,1.1405762573257402e-05,True,
Dependents,expected_total_from_payment_profile,ANOVA,27.398545390948662,1.7034184019364646e-07,True,
Dependents,expected_total_from_payment_profile,KRUSKAL,43.81086895700765,3.6169081887811306e-11,True,
Dependents,total_charges_per_month,ANOVA,96.25154059894876,1.4111815312147757e-22,True,
Dependents,total_charges_per_month,KRUSKAL,86.5963417013997,1.3309312009710203e-20,True,
PhoneService,tenure,ANOVA,0.500477884554003,0.4793136332609933,False,
PhoneService,tenure,KRUSKAL,0.49852120733546146,0.4801506124657583,False,
PhoneService,MonthlyCharges,ANOVA,459.4152291917001,8.759785775925438e-99,True,
PhoneService,MonthlyCharges,KRUSKAL,404.6113312952458,5.459086588038423e-90,True,
PhoneService,TotalCharges,ANOVA,91.35973557905899,1.6173608080664198e-21,True,
PhoneService,TotalCharges,KRUSKAL,51.30536250924328,7.905937837379851e-13,True,
PhoneService,expected_total_from_tenure_monthly,ANOVA,91.56710268452782,1.458409099060067e-21,True,
PhoneService,expected_total_from_tenure_monthly,KRUSKAL,50.9675359473815,9.390630848775994e-13,True,
PhoneService,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
PhoneService,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
PhoneService,expected_min_total_from_contract,ANOVA,22.229830963022863,2.4654069959829116e-06,True,
PhoneService,expected_min_total_from_contract,KRUSKAL,6.734445013113399,0.00945686496106972,True,
PhoneService,expected_total_senior,ANOVA,39.140680751546796,5.568964032396165e-10,True,
PhoneService,expected_total_senior,KRUSKAL,37.85816294189837,7.607938280557557e-10,True,
PhoneService,expected_total_from_payment_profile,ANOVA,91.56710268452782,1.458409099060067e-21,True,
PhoneService,expected_total_from_payment_profile,KRUSKAL,50.9675359473815,9.390630848775994e-13,True,
PhoneService,total_charges_per_month,ANOVA,461.25720510355336,3.683386795386751e-99,True,
PhoneService,total_charges_per_month,KRUSKAL,408.58156062712976,7.462521245768531e-91,True,
MultipleLines,tenure,ANOVA,470.6059899066235,1.490812784460338e-192,True,
MultipleLines,tenure,KRUSKAL,858.9490394956875,3.03100013326424e-187,True,
MultipleLines,MonthlyCharges,ANOVA,1195.8249992298188,0.0,True,
MultipleLines,MonthlyCharges,KRUSKAL,1983.5417012760504,0.0,True,
MultipleLines,TotalCharges,ANOVA,992.3012322746579,0.0,True,
MultipleLines,TotalCharges,KRUSKAL,1565.1039135038125,0.0,True,
MultipleLines,expected_total_from_tenure_monthly,ANOVA,993.5382411696311,0.0,True,
MultipleLines,expected_total_from_tenure_monthly,KRUSKAL,1566.5678831738267,0.0,True,
MultipleLines,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
MultipleLines,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
MultipleLines,expected_min_total_from_contract,ANOVA,249.8650570545993,1.4566070340381412e-105,True,
MultipleLines,expected_min_total_from_contract,KRUSKAL,286.0034472686266,7.85489751337303e-63,True,
MultipleLines,expected_total_senior,ANOVA,121.94054913174772,1.031084267917688e-48,True,
MultipleLines,expected_total_senior,KRUSKAL,213.6855135042441,3.969906800972998e-47,True,
MultipleLines,expected_total_from_payment_profile,ANOVA,993.5382411696311,0.0,True,
MultipleLines,expected_total_from_payment_profile,KRUSKAL,1566.5678831738267,0.0,True,
MultipleLines,total_charges_per_month,ANOVA,1185.8093038215816,0.0,True,
MultipleLines,total_charges_per_month,KRUSKAL,1960.8725892456682,0.0,True,
InternetService,tenure,ANOVA,5.376106106854902,0.004644810002915552,True,
InternetService,tenure,KRUSKAL,11.628968208072175,0.0029840193739948274,True,
InternetService,MonthlyCharges,ANOVA,16160.584443491358,0.0,True,
InternetService,MonthlyCharges,KRUSKAL,5529.747834096184,0.0,True,
InternetService,TotalCharges,ANOVA,802.0073465414886,1.648970038e-314,True,
InternetService,TotalCharges,KRUSKAL,1252.5958578438554,1.005230001411121e-272,True,
InternetService,expected_total_from_tenure_monthly,ANOVA,803.9436214809692,3.40796848e-315,True,
InternetService,expected_total_from_tenure_monthly,KRUSKAL,1254.8962973227665,3.1822284633137853e-273,True,
InternetService,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
InternetService,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
InternetService,expected_min_total_from_contract,ANOVA,138.01902938266238,1.6010130461141084e-59,True,
InternetService,expected_min_total_from_contract,KRUSKAL,39.81948020202417,2.2558475047396707e-09,True,
InternetService,expected_total_senior,ANOVA,38.889989529931334,4.5919317292368687e-17,True,
InternetService,expected_total_senior,KRUSKAL,69.18474437998081,9.478151406278e-16,True,
InternetService,expected_total_from_payment_profile,ANOVA,803.9436214809692,3.40796848e-315,True,
InternetService,expected_total_from_payment_profile,KRUSKAL,1254.8962973227665,3.1822284633137853e-273,True,
InternetService,total_charges_per_month,ANOVA,15353.837388643613,0.0,True,
InternetService,total_charges_per_month,KRUSKAL,5484.743503503759,0.0,True,
PaymentMethod,tenure,ANOVA,446.4750270313799,1.4885105720481231e-265,True,
PaymentMethod,tenure,KRUSKAL,1158.8573414648963,6.18949150377748e-251,True,
PaymentMethod,MonthlyCharges,ANOVA,450.7992597484254,6.451945827445105e-268,True,
PaymentMethod,MonthlyCharges,KRUSKAL,1103.2512441974302,7.173095887256946e-239,True,
PaymentMethod,TotalCharges,ANOVA,329.61298830000476,2.827024149917611e-200,True,
PaymentMethod,TotalCharges,KRUSKAL,1083.1265352463263,1.6662545142085725e-234,True,
PaymentMethod,expected_total_from_tenure_monthly,ANOVA,330.21392439268664,1.2836883068328294e-200,True,
PaymentMethod,expected_total_from_tenure_monthly,KRUSKAL,1084.4142019784265,8.75760970959e-235,True,
PaymentMethod,expected_total_for_zero_tenure,ANOVA,,,False,imbalanced groups
PaymentMethod,expected_total_for_zero_tenure,KRUSKAL,,,False,ERROR: All numbers are identical in kruskal
PaymentMethod,expected_min_total_from_contract,ANOVA,242.15351578152112,1.5246857657407978e-149,True,
PaymentMethod,expected_min_total_from_contract,KRUSKAL,812.7774065778557,7.329728323972313e-176,True,
PaymentMethod,expected_total_senior,ANOVA,49.009421770640735,8.631623017087522e-30,True,
PaymentMethod,expected_total_senior,KRUSKAL,143.96839645759397,5.268892622452465e-31,True,
PaymentMethod,expected_total_from_payment_profile,ANOVA,330.21392439268664,1.2836883068328294e-200,True,
PaymentMethod,expected_total_from_payment_profile,KRUSKAL,1084.4142019784265,8.75760970959e-235,True,
PaymentMethod,total_charges_per_month,ANOVA,448.7773903034031,8.205927920010034e-267,True,
PaymentMethod,total_charges_per_month,KRUSKAL,1097.5846867603013,1.2163758330321338e-237,True,