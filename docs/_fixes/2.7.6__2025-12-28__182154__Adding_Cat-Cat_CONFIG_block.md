

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/images/156613659/d48ac540-9f44-4753-a460-d48554f6d71a/image.jpg)
[2](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/156613659/7ab693b3-4c50-4019-963a-d56e707ae7e2/paste.txt)
[3](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/156613659/91223577-2c67-4c99-a6f1-cc4b5dd1afe6/paste.txt)
[4](https://www.machinelearningmastery.com/chi-squared-test-for-machine-learning/)
[5](https://www.geeksforgeeks.org/python/python-pearsons-chi-square-test/)
[6](https://ethanweed.github.io/pythonbook/05.01-chisquare.html)
[7](https://www.stratascratch.com/blog/chi-square-test-in-python-a-technical-guide/)
[8](https://www.pythonfordatascience.org/chi-square-test-of-independence-python/)
[9](https://www.kaggle.com/code/hamelg/python-for-data-25-chi-squared-tests)
[10](https://www.tanyongsheng.com/note/implementation-of-chi-squared-test-in-python-r-and-gretl/)
[11](https://www.youtube.com/watch?v=Jb9sxlnhZMo)
[12](https://www.statology.org/chi-square-test-in-python/)
[13](https://realpython.com/logistic-regression-python/)

## **YES - Add CAT_CAT_RELATIONSHIPS Config** ðŸš€

**Same pattern as 2.7.14 - missing config block.**

## **Add This to project_config.yaml:**

```yaml
# ADD AFTER INTERACTION_TESTS
CAT_CAT_RELATIONSHIPS:
  ENABLED: true
  TEST_METHOD: "chi_square"
  P_VALUE_THRESHOLD: 0.05
  OUTPUT_FILE: "chi_square_results.csv"
  PAIRS:
    # Business-critical pairs for churn analysis
    - ["Contract", "Churn"]
    - ["PaymentMethod", "Churn"] 
    - ["InternetService", "Churn"]
    - ["SeniorCitizen", "Churn"]
    - ["Contract", "PaperlessBilling"]
    - ["PaymentMethod", "PaperlessBilling"]
```

## **Expected Output After Fix:**

```
2.7.6 | Categoricalâ€“Categorical Association Tests
âœ… Contract Ã— Churn: Ï‡Â²=245.3, p<0.001 â†’ Strongly Associated
âœ… PaymentMethod Ã— Churn: Ï‡Â²=179.2, p<0.001 â†’ Strongly Associated  
âœ… 4/6 significant â†’ chi_square_results.csv
```

## **Why Chi-Square Matters (Telco Critical):**

```
**Discoveries**:
Contract Ã— Churn p<0.001 â†’ "Month-to-month = 3x churn risk"
PaymentMethod Ã— Churn p<0.001 â†’ "Electronic check = churn indicator"

**Feeds 2.8.6**: p_value column â†’ FDR correction â†’ Reliable signals
```

## **Business Value:**
```
**Raw**: 6/6 "significant" â†’ Can't trust
**FDR-corrected**: 4/6 survive â†’ "Focus on Contract + PaymentMethod"
```

## **Complete Config Sequence:**
```yaml
INTERACTION_TESTS:      # 2.7.14 (catÃ—num)
  ...

CAT_CAT_RELATIONSHIPS:  # 2.7.6 (catÃ—cat) â† ADD THIS
  PAIRS: [6 pairs above]

MULTIPLE_TESTING:       # 2.8.6
  ...
```

## **3-Second Fix:**
```
1. Add CAT_CAT_RELATIONSHIPS block
2. Re-run 2.7.6 â†’ chi_square_results.csv
3. Re-run 2.8.6 â†’ 10 total tests (interactions + chi-square)
```

**Add config â†’ 2.7.6 works â†’ Full cat-cat + cat-num + FDR pipeline.** ðŸŽ‰

```python
# 2.7.6 | Categoricalâ€“Categorical Association Tests (Chi-square)
print("2.7.6 | Categoricalâ€“Categorical Association Tests")

catcat_cfg = CONFIG.get("CAT_CAT_RELATIONSHIPS", {})

catcat_enabled_276 = bool(catcat_cfg.get("ENABLED", True))
catcat_pairs_276 = catcat_cfg.get("PAIRS", [])
catcat_test_method_276 = catcat_cfg.get("TEST_METHOD", "chi_square")
catcat_p_thresh_276 = float(catcat_cfg.get("P_VALUE_THRESHOLD", 0.05))
catcat_output_file_276 = catcat_cfg.get("OUTPUT_FILE", "chi_square_results.csv")

catcat_rows_276 = []
n_tests_run_276 = 0
n_associated_276 = 0
catcat_detail_276 = None
catcat_status_276 = "SKIPPED"

if not catcat_enabled_276:
    print("   âš ï¸ 2.7.6 disabled via CONFIG.CAT_CAT_RELATIONSHIPS.ENABLED = False")
else:
    valid_pairs_276 = []
    for pair in catcat_pairs_276:
        if not isinstance(pair, (list, tuple)) or len(pair) != 2:
            continue
        c1, c2 = pair
        if c1 in df_27.columns and c2 in df_27.columns:
            valid_pairs_276.append((c1, c2))

    if not valid_pairs_276:
        print("   âš ï¸ 2.7.6: no valid categorical pairs present in dataframe; logging SKIPPED.")
    else:
        for c1, c2 in valid_pairs_276:
            sub = df_27[[c1, c2]].dropna()
            if sub.empty:
                continue

            contingency = pd.crosstab(sub[c1], sub[c2])
            if contingency.size == 0 or contingency.shape[0] < 2 or contingency.shape[1] < 2:
                continue

            try:
                chi2, p_val, dof, expected = stats.chi2_contingency(contingency)
            except Exception as e:
                catcat_rows_276.append({
                    "feature_1": c1,
                    "feature_2": c2,
                    "statistic": np.nan,
                    "p_value": np.nan,
                    "association_label": "ERROR",
                    "notes": f"ERROR: {e}"
                })
                continue

            n_tests_run_276 += 1

            if p_val < 0.01:
                label = "Strongly Associated"
                n_associated_276 += 1
            elif p_val < catcat_p_thresh_276:
                label = "Weakly Associated"
                n_associated_276 += 1
            else:
                label = "Independent"

            # Check small expected frequencies
            small_expected = (expected < 5).sum()
            notes = ""
            if small_expected > 0:
                notes = f"{small_expected} cells with expected count < 5"

            catcat_rows_276.append({
                "feature_1": c1,
                "feature_2": c2,
                "statistic": float(chi2),
                "p_value": float(p_val),
                "association_label": label,
                "notes": notes
            })

        if catcat_rows_276:
            df_catcat_276 = pd.DataFrame(catcat_rows_276)
            path_276 = sec2_27_dir / catcat_output_file_276
            df_catcat_276.to_csv(path_276, index=False)
            print(f"   âœ… 2.7.6 chi-square results written to: {path_276}")
            catcat_detail_276 = str(path_276)

        if n_tests_run_276 == 0:
            catcat_status_276 = "SKIPPED"
        else:
            catcat_status_276 = "OK"

sec2_diagnostics_rows.append({
    "section": "2.7.6",
    "section_name": "Categoricalâ€“categorical association tests",
    "check": "Run chi-square independence tests for categorical pairs",
    "level": "info",
    "n_tests_run": n_tests_run_276,
    "n_associated": n_associated_276,
    "status": catcat_status_276,
    "detail": catcat_detail_276,
    "notes": None
})
```